# Users API Paths
# User-Service Base path: /api/users

# User Management

users:
  post:
    tags:
      - Users
    summary: Create a new user
    description: |
      Create a new user in the system. This endpoint is typically called
      by the auth-service after successful registration.
    operationId: createUser
    security:
      - ApiKeyAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/user.yaml#/CreateUserRequest'
    responses:
      '201':
        description: User created successfully
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '400':
        description: Invalid input
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/ValidationError'
      '409':
        description: Email or username already exists
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

user-by-id:
  get:
    tags:
      - Users
    summary: Get user by ID
    description: Get a user's data by their unique identifier
    operationId: getUserById
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: User data
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  put:
    tags:
      - Users
    summary: Update user
    description: Update user's basic information
    operationId: updateUser
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/user.yaml#/UpdateUserRequest'
    responses:
      '200':
        description: User updated
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '400':
        description: Invalid input
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/ValidationError'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  delete:
    tags:
      - Users
    summary: Deactivate user
    description: Soft-delete a user by setting their status to DEACTIVATED
    operationId: deactivateUser
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: User deactivated
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

user-by-email:
  get:
    tags:
      - Users
      - Search
    summary: Get user by email
    description: Get a user's data by their email address
    operationId: getUserByEmail
    security:
      - ApiKeyAuth: []
    parameters:
      - name: email
        in: path
        required: true
        schema:
          type: string
          format: email
    responses:
      '200':
        description: User data
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

user-by-username:
  get:
    tags:
      - Users
      - Search
    summary: Get user by username
    description: Get a user's data by their username
    operationId: getUserByUsername
    security:
      - ApiKeyAuth: []
    parameters:
      - name: username
        in: path
        required: true
        schema:
          type: string
    responses:
      '200':
        description: User data
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

# Admin Operations

user-suspend:
  post:
    tags:
      - Users
      - Admin
    summary: Suspend user
    description: Suspend a user account. Suspended users cannot access the system until reactivated.
    operationId: suspendUser
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: User suspended
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

# Search

search:
  get:
    tags:
      - Users
      - Search
    summary: Search users
    description: Search for users by query string with optional filtering and pagination
    operationId: searchUsers
    security:
      - ApiKeyAuth: []
    parameters:
      - name: query
        in: query
        required: true
        description: Search query (min 2 characters)
        schema:
          type: string
          minLength: 2
          maxLength: 100
      - name: status
        in: query
        required: false
        description: Filter by user status
        schema:
          type: string
          enum: [ACTIVE, INACTIVE, SUSPENDED, DEACTIVATED]
      - name: page
        in: query
        required: false
        description: Page number (0-indexed)
        schema:
          type: integer
          minimum: 0
          default: 0
      - name: size
        in: query
        required: false
        description: Page size
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
    responses:
      '200':
        description: Search results
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/PagedApiResponse'

# Batch Operations

batch:
  post:
    tags:
      - Users
      - Batch
    summary: Get users by IDs
    description: |
      Retrieve multiple users by their IDs in a single request.
      Useful for populating user data in lists.
      Users not found will be silently omitted from the response.
    operationId: getUsersByIds
    security:
      - ApiKeyAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: array
            items:
              type: string
              format: uuid
            maxItems: 100
    responses:
      '200':
        description: List of users
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/BatchApiResponse'

# Profile Management

profile:
  get:
    tags:
      - Users
      - Profile
    summary: Get user profile
    description: Retrieve extended profile information for a user
    operationId: getProfile
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: User profile
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ProfileApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  patch:
    tags:
      - Users
      - Profile
    summary: Update user profile
    description: Update profile fields. Only provided fields will be updated.
    operationId: updateProfile
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/user.yaml#/UpdateProfileRequest'
    responses:
      '200':
        description: Profile updated
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/ProfileApiResponse'
      '400':
        description: Invalid input
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/ValidationError'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

# Preferences Management

preferences:
  get:
    tags:
      - Users
      - Preferences
    summary: Get user preferences
    description: Retrieve user notification, display, and privacy preferences
    operationId: getPreferences
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: User preferences
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/PreferencesApiResponse'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'

  patch:
    tags:
      - Users
      - Preferences
    summary: Update user preferences
    description: Update preference fields. Only provided fields will be updated.
    operationId: updatePreferences
    security:
      - ApiKeyAuth: []
    parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/user.yaml#/UpdatePreferencesRequest'
    responses:
      '200':
        description: Preferences updated
        content:
          application/json:
            schema:
              $ref: '../schemas/user.yaml#/PreferencesApiResponse'
      '400':
        description: Invalid input
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/ValidationError'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../schemas/error.yaml#/Error'
